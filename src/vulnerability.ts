import {VulnerabilityId} from './scanner'
import {TideliftRecommendation} from './tidelift_recommendation'

type VulnerabilityData = {
  description: string
  severity: number
  url: string
  nist_url: string
  recommendation?: TideliftRecommendation
}

export class Vulnerability implements VulnerabilityData {
  vuln_id: VulnerabilityId
  description: string
  severity: number
  url: string
  nist_url: string
  recommendation?: TideliftRecommendation

  constructor(vuln_id: VulnerabilityId, data: VulnerabilityData) {
    this.vuln_id = vuln_id
    this.description = data['description']
    this.severity = data['severity']
    this.url = data['url']
    this.nist_url = data['nist_url']
    if (data['recommendation']) {
      this.recommendation = new TideliftRecommendation(data['recommendation'])
    }
  }
}
